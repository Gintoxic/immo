continue<-1
counter<-0
while (continue=1)
{
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
url<-paste(before, pagenum,type, region, sep="/")
doc<-htmlParse(url, encoding="UTF-8")
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
if(counter==1)
{
frameAll<-frame
frameLast<-frame
}else{
if(identical(frame,frameLast) | maxEntries>maxEntries)
{
continue=0
}
frameAll<-rbind(frameAll, frame)
frameLast<-frame
}#else
}#while
}#function
library(XML)
library(rjson)
getImmo<-function (type="Wohnung-Miete",region="Rheinland-Pfalz/Koblenz", maxEntries=10)
{
before<-"http://www.immobilienscout24.de/Suche/S-T"
#after<-""
#"http://www.immobilienscout24.de/Suche/S-T/Wohnung-Miete/Rheinland-Pfalz/Koblenz?enteredFrom=one_step_search"
#http://www.immobilienscout24.de/Suche/S-T/P-002/Wohnung-Miete/Rheinland-Pfalz/Koblenz?pagerReporting=true
continue<-1
counter<-0
while (continue=1)
{
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
url<-paste(before, pagenum,type, region, sep="/")
doc<-htmlParse(url, encoding="UTF-8")
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
if(counter==1)
{
frameAll<-frame
frameLast<-frame
}else{
if(identical(frame,frameLast) | maxEntries>maxEntries)
{
continue=0
}
frameAll<-rbind(frameAll, frame)
frameLast<-frame
}#else
}#while
}#function
library(XML)
library(rjson)
getImmo<-function (type="Wohnung-Miete",region="Rheinland-Pfalz/Koblenz", maxEntries=10)
{
before<-"http://www.immobilienscout24.de/Suche/S-T"
#after<-""
#"http://www.immobilienscout24.de/Suche/S-T/Wohnung-Miete/Rheinland-Pfalz/Koblenz?enteredFrom=one_step_search"
#http://www.immobilienscout24.de/Suche/S-T/P-002/Wohnung-Miete/Rheinland-Pfalz/Koblenz?pagerReporting=true
continue<-1
counter<-0
while (continue==1)
{
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
url<-paste(before, pagenum,type, region, sep="/")
doc<-htmlParse(url, encoding="UTF-8")
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
if(counter==1)
{
frameAll<-frame
frameLast<-frame
}else{
if(identical(frame,frameLast) | maxEntries>maxEntries)
{
continue=0
}
frameAll<-rbind(frameAll, frame)
frameLast<-frame
}#else
}#while
}#function
getImmo(region = "Rheinland-Pfalz/Koblenz")
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
library(XML)
library(rjson)
getImmo<-function (type="Wohnung-Miete",region="Rheinland-Pfalz/Koblenz", maxEntries=10)
{
before<-"http://www.immobilienscout24.de/Suche/S-T"
#after<-""
#"http://www.immobilienscout24.de/Suche/S-T/Wohnung-Miete/Rheinland-Pfalz/Koblenz?enteredFrom=one_step_search"
#http://www.immobilienscout24.de/Suche/S-T/P-002/Wohnung-Miete/Rheinland-Pfalz/Koblenz?pagerReporting=true
continue<-1
counter<-0
while (continue==1)
{
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
url<-paste(before, pagenum,type, region, sep="/")
doc<-htmlParse(url, encoding="UTF-8")
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
if(counter==1)
{
frameAll<-frame
frameLast<-frame
}else{
if(identical(frame,frameLast) | maxEntries>maxEntries)
{
continue=0
}
frameAll<-rbind(frameAll, frame)
frameLast<-frame
}#else
}#while
return(frameAll)
}#function
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
library(XML)
library(rjson)
getImmo<-function (type="Wohnung-Miete",region="Rheinland-Pfalz/Koblenz", maxEntries=10)
{
before<-"http://www.immobilienscout24.de/Suche/S-T"
#after<-""
#"http://www.immobilienscout24.de/Suche/S-T/Wohnung-Miete/Rheinland-Pfalz/Koblenz?enteredFrom=one_step_search"
#http://www.immobilienscout24.de/Suche/S-T/P-002/Wohnung-Miete/Rheinland-Pfalz/Koblenz?pagerReporting=true
continue<-1
counter<-0
while (continue==1)
{
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
url<-paste(before, pagenum,type, region, sep="/")
doc<-htmlParse(url, encoding="UTF-8")
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
if(counter==0)
{
frameAll<-frame
frameLast<-frame
}else{
if(identical(frame,frameLast) | maxEntries>maxEntries)
{
continue=0
}
frameAll<-rbind(frameAll, frame)
frameLast<-frame
}#else
counter<-counter+1
}#while
return(frameAll)
}#function
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
source('D:/Work/immo/getImmo.R')
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
f
type="Wohnung-Miete",region="Rheinland-Pfalz/Koblenz", maxEntries=10
type="Wohnung-Miete"
region="Rheinland-Pfalz/Koblenz"
maxEntries=10
before<-"http://www.immobilienscout24.de/Suche/S-T"
continue<-1
counter<-0
continue
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
pagenum
url<-paste(before, pagenum,type, region, sep="/")
url
doc<-htmlParse(url, encoding="UTF-8")
doc
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
fj
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
frame
frameAll<-frame
frameLast<-frame
counter
counter<-counter+1
counter>maxEntries
counter
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
pagenum
url<-paste(before, pagenum,type, region, sep="/")
doc<-htmlParse(url, encoding="UTF-8")
ch<-as(doc, "character")
jsonstart<-regexpr("model:",ch)[1]+7
jsonend<-regexpr("travelTimeModel",ch)[1]-1
chjson<-substr(ch, jsonstart,jsonend)
fj<-fromJSON(chjson)
attriblist<-c("id","cwid", "privateOffer" ,"title", "address", "district","city", "zip", "attributes")
empty<-matrix(nrow=length(fj$results), ncol=length(attriblist))
colnames(empty)<-attriblist
frame<-as.data.frame(empty)
for (i in 1:length(fj$results))
{
cur<-fj$results[[i]]
for (j in 1:length(attriblist))
{
if (attriblist[j]!="attributes")
{
frame[i,attriblist[j]]<-cur[[attriblist[j]]]
}else{
frame[i,attriblist[j]]<-paste(cur[[attriblist[j]]], collapse=";")
}
}# for
}# for
frame
url
source('D:/Work/immo/getImmo.R')
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
f
source('D:/Work/immo/getImmo.R')
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
f
source('D:/Work/immo/getImmo.R')
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
f
getwd()
region = "Rheinland-Pfalz/Koblenz"
gsub(region,"/","_")
gsub("/","_",region)
region_<-gsub("/","_",region)
Sys.Date
Sys.Date()
Sys.time()
format(Sys.time(), "%d")
format(Sys.time(), "%Y%d")
format(Sys.time(), "%Y%m%d")
f$date<-Sys.Date()
f
date_<-format(Sys.Date(), "%Y%m%d")
date_
filename<-paste(region_, "_",date_, sep="")
filename
f<-getImmo(region = "Rheinland-Pfalz/Koblenz")
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
filenameCSV<-paste(region_, "_",date_, sep="")
filenameCSV<-paste(region_, "_",date_, ".csv",sep="")
filenameCSV<-paste("../immoData/",region_, "_",date_, ".csv",sep="")
filenameCSV
"../immoData/date_"
dir.create("../immoData/date_")
dir.create(paste("../immoData/",date_, sep="")
)
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
filenameCSV
write.table(f,file =  filenameCSV, row.names = F)
write.table(f,file =  filenameCSV, row.names = F, sep=";")
source('D:/Work/immo/getImmo.R')
region = "Rheinland-Pfalz/Mainz"
f<-getImmo(region)
f
source('D:/Work/immo/getImmo.R')
f<-getImmo(region)
region = "Rheinland-Pfalz/Koblenz"
f<-getImmo(region)
url<-"http://www.immobilienscout24.de/Suche/S-T/Wohnung-Miete/Rheinland-Pfalz/Koblenz?enteredFrom=one_step_search"
doc<-htmlParse(url, encoding="UTF-8")
doc
type="Wohnung-Miete"
region="Rheinland-Pfalz/Koblenz"
before<-"http://www.immobilienscout24.de/Suche/S-T"
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
source('D:/Work/immo/getImmo.R')
region = "Rheinland-Pfalz/Mainz"
f<-getImmo(region)
print(url)
url<-paste(before, pagenum,type, region, sep="/")
before<-"http://www.immobilienscout24.de/Suche/S-T"
type="Wohnung-Miete"
region="Rheinland-Pfalz/Koblenz"
maxPages=20
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
counter<-1
pagenum<-paste("P-",formatC(counter, width = 3, format = "d", flag = "0"), sep="")
url<-paste(before, pagenum,type, region, sep="/")
url
source('D:/Work/immo/getImmo.R')
f<-getImmo(region)
url<-paste(before, pagenum,type, region, sep="/")
url
source('D:/Work/immo/getImmo.R')
f<-getImmo(region)
source('D:/Work/immo/getImmo.R')
f$date<-Sys.Date()
f<-getImmo(region)
f<-getImmo(region)
f<-getImmo(region=region)
myregion = "Rheinland-Pfalz/Koblenz"
f<-getImmo(region=myregion)
f
source('D:/Work/immo/getImmo.R')
source('D:/Work/immo/getImmo.R')
myregion = "Rheinland-Pfalz/Koblenz"
f<-getImmo(region=myregion)
f<-getImmo(region=myregion,maxPages = 1000)
f
source('D:/Work/immo/getImmo.R')
myregion = "Rheinland-Pfalz/Mainz"
f<-getImmo(region=myregion,maxPages = 1000)
f
source('D:/Work/immo/getImmo.R')
myregion = "Rheinland-Pfalz/Mainz"
f<-getImmo(region=myregion,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep=";")
region = "Rheinland-Pfalz/Mainz"
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep=";")
write.table(f,file =  filenameCSV, row.names = F, sep=";", encoding="UTF-8")
write.table(f,file =  filenameCSV, row.names = F, sep=";", encode="UTF-8")
write.table(f,file =  filenameCSV, row.names = F, sep=";", fileEncoding="UTF-8")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8")
source('D:/Work/immo/getImmo.R')
source('D:/Work/immo/getImmo.R')
region = "Rheinland-Pfalz/Mainz"
f<-getImmo(region=region,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8", quote = F)
region = "Rheinland-Pfalz/Koblenz"
f<-getImmo(region=region,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8", quote = F)
region = "Berlin/Berlin"
f<-getImmo(region=region,maxPages = 1000)
f
table(f$district)
region = "Hamburg/Hamburg"
f<-getImmo(region=region,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8", quote = F)
table(f$district)
region = "Bremen/Bremen"
f<-getImmo(region=region,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8", quote = F)
table(f$district)
region = "Nordrhein-Westfalen/Koeln"
f<-getImmo(region=region,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8", quote = F)
table(f$district)
region = "Nordrhein-Westfalen/Bonn"
f<-getImmo(region=region,maxPages = 1000)
f$date<-Sys.Date()
f$region<-region
region_<-gsub("/","_",region)
date_<-format(Sys.Date(), "%Y%m%d")
dir.create(paste("../immoData/",date_, sep=""))
filenameCSV<-paste("../immoData/",date_,"/",region_, "_",date_, ".csv",sep="")
write.table(f,file =  filenameCSV, row.names = F, sep="\t", fileEncoding="UTF-8", quote = F)
table(f$district)
